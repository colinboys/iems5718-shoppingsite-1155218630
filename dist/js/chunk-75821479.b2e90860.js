(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-75821479"],{"0658":function(e,t,a){"use strict";a("7894")},"1cd9":function(e,t,a){"use strict";a("9479")},"1d19":function(e,t,a){"use strict";a("96b6")},"2a84":function(e,t,a){},3530:function(e,t,a){"use strict";a.r(t);var c=a("7a23"),l=a("b775");const n={class:"admin-container"},o={class:"data-table"},r={class:"actions"},i=["onClick"],d=["onClick"],u={key:0,class:"modal"},s={class:"modal-content"},b={class:"form-group"};var m={__name:"CategoryAdmin",setup(e){const t=Object(c["ref"])([]),a=Object(c["ref"])(!1),m=Object(c["ref"])({name:""}),O=Object(c["ref"])(null),j=Object(c["ref"])(!1),p=Object(c["computed"])(()=>j.value?"Edit Category":"Add Category"),v=async()=>{const e=await l["a"].get("/api/categories");t.value=e.data},E=()=>{j.value=!1,m.value={name:""},a.value=!0},N=e=>{j.value=!0,m.value={...e},O.value=e.catid,a.value=!0},V=async()=>{try{j.value?await l["a"].put("/api/categories/"+O.value,m.value,{headers:{Authorization:""+localStorage.getItem("auth_token")}}):await l["a"].post("/api/categories",m.value,{headers:{Authorization:""+localStorage.getItem("auth_token")}}),await v(),k()}catch(e){console.error("操作失败:",e)}},g=async e=>{confirm("确定要删除该分类吗？")&&(await l["a"].delete("/api/categories/"+e,{headers:{Authorization:""+localStorage.getItem("auth_token")}}),await v())},k=()=>{a.value=!1};return Object(c["onMounted"])(v),(e,l)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",n,[Object(c["createElementVNode"])("div",{class:"action-bar"},[Object(c["createElementVNode"])("button",{class:"btn primary",onClick:E},"Add Category")]),Object(c["createElementVNode"])("table",o,[l[1]||(l[1]=Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"ID"),Object(c["createElementVNode"])("th",null,"Name"),Object(c["createElementVNode"])("th",null,"Operation")])],-1)),Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(t.value,e=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:e.catid},[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.catid),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.name),1),Object(c["createElementVNode"])("td",r,[Object(c["createElementVNode"])("button",{class:"btn edit",onClick:t=>N(e)},"Edit",8,i),Object(c["createElementVNode"])("button",{class:"btn danger",onClick:t=>g(e.catid)},"Delete",8,d)])]))),128))])]),a.value?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",u,[Object(c["createElementVNode"])("div",s,[Object(c["createElementVNode"])("h3",null,Object(c["toDisplayString"])(p.value),1),Object(c["createElementVNode"])("form",{onSubmit:Object(c["withModifiers"])(V,["prevent"])},[Object(c["createElementVNode"])("div",b,[l[2]||(l[2]=Object(c["createElementVNode"])("label",null,"Category Name",-1)),Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=e=>m.value.name=e),required:"",class:"form-input"},null,512),[[c["vModelText"],m.value.name]])]),Object(c["createElementVNode"])("div",{class:"form-actions"},[Object(c["createElementVNode"])("button",{type:"button",class:"btn",onClick:k},"取消"),l[3]||(l[3]=Object(c["createElementVNode"])("button",{type:"submit",class:"btn primary"},"提交",-1))])],32)])])):Object(c["createCommentVNode"])("",!0)]))}},O=(a("7049"),a("6b0d")),j=a.n(O);const p=j()(m,[["__scopeId","data-v-c0214176"]]);var v=p;a("0643"),a("fffc");const E={class:"admin-container"},N={class:"data-table"},V=["src"],g={key:1},k={class:"actions"},y=["onClick"],h=["onClick"],f={key:0,class:"modal"},B={class:"modal-content"},C={class:"form-group"},_={class:"form-group"},D=["value"],w={class:"form-group"},S={class:"form-group"},I={class:"form-group"},A={key:0,class:"upload-status"},P={key:0},M=["src"];var z={__name:"ProductAdmin",setup(e){const t=Object(c["ref"])("https://s20.iems5718.ie.cuhk.edu.hk:8000"),a=Object(c["ref"])([]),n=Object(c["ref"])([]),o=Object(c["ref"])(!1),r=Object(c["ref"])({name:"",catid:"",price:0,description:"",image_url:"",thumbnail_url:""}),i=Object(c["ref"])(null),d=Object(c["ref"])(!1),u=Object(c["ref"])(""),s=Object(c["ref"])(""),b=Object(c["ref"])(!1),m=Object(c["computed"])(()=>d.value?"Edit Product":"Add Product"),O=async()=>{const e=await l["a"].get("/api/products");a.value=e.data,console.log(a.value);for(let t=0;t<a.value.length;t++)a.value[t].cname=n.value.find(e=>e.catid===a.value[t].catid).name},j=async()=>{const e=await l["a"].get("/api/categories");n.value=e.data},p=()=>{d.value=!1,r.value={name:"",catid:"",price:0,description:"",image_url:"",thumbnail_url:""},o.value=!0},v=e=>{d.value=!0,r.value={...e},i.value=e.pid,o.value=!0},z=()=>r.value.name.trim()?r.value.catid?!(r.value.price<=0)||(alert("The price must be greater than 0"),!1):(alert("Please select product category"),!1):(alert("Product name can not be blank"),!1),F=async()=>{if(z())try{d.value?await l["a"].put("/api/products/"+i.value,r.value,{headers:{Authorization:""+localStorage.getItem("auth_token")}}):await l["a"].post("/api/products",r.value,{headers:{Authorization:""+localStorage.getItem("auth_token")}}),await O(),$()}catch(e){console.error("操作失败:",e)}},T=async e=>{confirm("Are you sure you want to delete this product?")&&(await l["a"].delete("/api/products/"+e,{headers:{Authorization:""+localStorage.getItem("auth_token")}}),await O(),confirm("Delete Successful"))},U=e=>{b.value=!0},x=e=>{b.value=!1},L=e=>{b.value=!1;const t=e.dataTransfer.files[0];t&&t.type.startsWith("image/")?J(t):alert("Please drop an image file")},q=e=>{const t=e.target.files[0];t&&J(t)},J=e=>{const t=e.target.files[0]||e.dataTransfer.files[0];if(!t)return;if(!t.type.startsWith("image/"))return void alert("Please select an image file");if(t.size>5242880)return void alert("Image size should be less than 5MB");const a=new FileReader;a.onload=e=>{s.value=e.target.result},a.readAsDataURL(t),R(t)},R=async e=>{const t=new FormData;t.append("file",e);try{const e=await l["a"].post("/api/upload-image",t,{headers:{"Content-Type":"multipart/form-data",Authorization:""+localStorage.getItem("auth_token")}});r.value.image_url=e.data.image_url,r.value.thumbnail_url=e.data.thumbnail_url}catch(a){console.error("Failed to upload image:",a),alert("Failed to upload image")}},W=()=>{s.value="",r.value.image_url="",r.value.thumbnail_url="",fileInput.value&&(fileInput.value.value="")},$=()=>{o.value=!1};return Object(c["onMounted"])(()=>{j(),O()}),(e,l)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",E,[Object(c["createElementVNode"])("div",{class:"action-bar"},[Object(c["createElementVNode"])("button",{class:"btn primary",onClick:p},"Add Product")]),Object(c["createElementVNode"])("table",N,[l[4]||(l[4]=Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"ID"),Object(c["createElementVNode"])("th",null,"Prooduct Name"),Object(c["createElementVNode"])("th",null,"Category"),Object(c["createElementVNode"])("th",null,"Price"),Object(c["createElementVNode"])("th",null,"Description"),Object(c["createElementVNode"])("th",null,"Picture"),Object(c["createElementVNode"])("th",null,"Operation")])],-1)),Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(a.value,e=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:e.pid},[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.pid),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.name),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.cname),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.price),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.description),1),Object(c["createElementVNode"])("td",null,[e.thumbnail_url?(Object(c["openBlock"])(),Object(c["createElementBlock"])("img",{key:0,src:t.value+e.thumbnail_url,class:"thumbnail"},null,8,V)):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",g,"Not Found Image"))]),Object(c["createElementVNode"])("td",k,[Object(c["createElementVNode"])("button",{class:"btn edit",onClick:t=>v(e)},"Edit",8,y),Object(c["createElementVNode"])("button",{class:"btn danger",onClick:t=>T(e.pid)},"Delete",8,h)])]))),128))])]),o.value?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",f,[Object(c["createElementVNode"])("div",B,[Object(c["createElementVNode"])("h3",null,Object(c["toDisplayString"])(m.value),1),Object(c["createElementVNode"])("form",{onSubmit:Object(c["withModifiers"])(F,["prevent"])},[Object(c["createElementVNode"])("div",C,[l[5]||(l[5]=Object(c["createElementVNode"])("label",null,"Name",-1)),Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=e=>r.value.name=e),required:"",class:"form-input"},null,512),[[c["vModelText"],r.value.name]])]),Object(c["createElementVNode"])("div",_,[l[6]||(l[6]=Object(c["createElementVNode"])("label",null,"Category",-1)),Object(c["withDirectives"])(Object(c["createElementVNode"])("select",{"onUpdate:modelValue":l[1]||(l[1]=e=>r.value.catid=e),required:"",class:"form-input"},[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(n.value,e=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("option",{key:e.catid,value:e.catid},Object(c["toDisplayString"])(e.name),9,D))),128))],512),[[c["vModelSelect"],r.value.catid]])]),Object(c["createElementVNode"])("div",w,[l[7]||(l[7]=Object(c["createElementVNode"])("label",null,"Price",-1)),Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{type:"number","onUpdate:modelValue":l[2]||(l[2]=e=>r.value.price=e),step:"0.01",required:"",class:"form-input"},null,512),[[c["vModelText"],r.value.price]])]),Object(c["createElementVNode"])("div",S,[l[8]||(l[8]=Object(c["createElementVNode"])("label",null,"Description",-1)),Object(c["withDirectives"])(Object(c["createElementVNode"])("textarea",{"onUpdate:modelValue":l[3]||(l[3]=e=>r.value.description=e),class:"form-input"},null,512),[[c["vModelText"],r.value.description]])]),Object(c["createElementVNode"])("div",I,[l[9]||(l[9]=Object(c["createElementVNode"])("label",null,"Upload Picture",-1)),Object(c["createElementVNode"])("input",{type:"file",onChange:J,accept:"image/*",ref:"fileInput"},null,544),u.value?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",A,Object(c["toDisplayString"])(u.value),1)):Object(c["createCommentVNode"])("",!0)]),Object(c["createElementVNode"])("div",{class:Object(c["normalizeClass"])(["drop-zone",{"drag-over":b.value}]),onDrop:Object(c["withModifiers"])(L,["prevent"]),onDragover:Object(c["withModifiers"])(U,["prevent"]),onDragleave:Object(c["withModifiers"])(x,["prevent"])},[s.value?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",P,"Drag & drop image here or click to upload")),Object(c["createElementVNode"])("input",{type:"file",ref:"fileInput",onChange:q,accept:"image/*",style:{display:"none"}},null,544),s.value?(Object(c["openBlock"])(),Object(c["createElementBlock"])("img",{key:1,src:s.value,class:"image-preview",alt:"Preview"},null,8,M)):Object(c["createCommentVNode"])("",!0),s.value?(Object(c["openBlock"])(),Object(c["createElementBlock"])("button",{key:2,onClick:Object(c["withModifiers"])(W,["prevent"]),class:"clear-image"},"×")):Object(c["createCommentVNode"])("",!0)],34),Object(c["createElementVNode"])("div",{class:"form-actions"},[Object(c["createElementVNode"])("button",{type:"button",class:"btn",onClick:$},"Cancel"),l[10]||(l[10]=Object(c["createElementVNode"])("button",{type:"submit",class:"btn primary"},"Submit",-1))])],32)])])):Object(c["createCommentVNode"])("",!0)]))}};a("1cd9");const F=j()(z,[["__scopeId","data-v-cdd9cd9a"]]);var T=F;const U={class:"order-admin"},x={class:"orders-list"},L=["onClick"],q={key:0},J={key:1},R={key:0,class:"modal"},W={class:"modal-content"};var $={__name:"OrderAdmin",setup(e){const t=Object(c["ref"])([]),a=Object(c["ref"])(!1),n=Object(c["ref"])([]),o=async()=>{try{const e=await l["a"].get("/api/admin/orders",{headers:{Authorization:""+localStorage.getItem("auth_token")}});t.value=e.data}catch(e){console.error("Failed to fetch orders:",e)}},r=e=>{try{n.value="string"===typeof e.items?JSON.parse(e.items):e.items,a.value=!0}catch(t){console.error("Failed to parse order items:",t),alert("Error displaying order items")}},i=e=>new Date(e).toLocaleString();return Object(c["onMounted"])(()=>{o()}),(e,l)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",U,[Object(c["createElementVNode"])("div",x,[Object(c["createElementVNode"])("table",null,[l[1]||(l[1]=Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"Order ID"),Object(c["createElementVNode"])("th",null,"User ID"),Object(c["createElementVNode"])("th",null,"Total Price"),Object(c["createElementVNode"])("th",null,"Items"),Object(c["createElementVNode"])("th",null,"Status"),Object(c["createElementVNode"])("th",null,"Payment Status"),Object(c["createElementVNode"])("th",null,"Created At"),Object(c["createElementVNode"])("th",null,"Paid At")])],-1)),Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(t.value,e=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:e.order_id},[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.order_id),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.user_id),1),Object(c["createElementVNode"])("td",null,"$"+Object(c["toDisplayString"])(e.total_price),1),Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("button",{onClick:t=>r(e),class:"view-items-btn"}," View Items ",8,L)]),Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("span",{class:Object(c["normalizeClass"])(["status-badge",e.status])},Object(c["toDisplayString"])(e.status),3)]),Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("span",{class:Object(c["normalizeClass"])(["payment-badge",e.payment_status])},Object(c["toDisplayString"])(e.payment_status),3)]),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(i(e.created_at)),1),"paid"==e.payment_status?(Object(c["openBlock"])(),Object(c["createElementBlock"])("td",q,Object(c["toDisplayString"])(i(e.paid_at)),1)):Object(c["createCommentVNode"])("",!0),"unpaid"==e.payment_status?(Object(c["openBlock"])(),Object(c["createElementBlock"])("td",J,"Unpaid ")):Object(c["createCommentVNode"])("",!0)]))),128))])])]),a.value?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",R,[Object(c["createElementVNode"])("div",W,[l[3]||(l[3]=Object(c["createElementVNode"])("h3",null,"Order Items",-1)),Object(c["createElementVNode"])("table",null,[l[2]||(l[2]=Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"Product ID"),Object(c["createElementVNode"])("th",null,"Name"),Object(c["createElementVNode"])("th",null,"Quantity"),Object(c["createElementVNode"])("th",null,"Price")])],-1)),Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(n.value,e=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:e.pid},[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.pid),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.name),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.quantity),1),Object(c["createElementVNode"])("td",null,"$"+Object(c["toDisplayString"])((e.price*e.quantity).toFixed(2)),1)]))),128))])]),Object(c["createElementVNode"])("button",{onClick:l[0]||(l[0]=e=>a.value=!1),class:"close-btn"},"Close")])])):Object(c["createCommentVNode"])("",!0)]))}};a("0658");const Q=j()($,[["__scopeId","data-v-463c7609"]]);var G=Q;const H={class:"admin-home"},K={class:"tabs"},X={class:"tab-content"};var Y={__name:"Admin",setup(e){const t=Object(c["ref"])("categories");return(e,a)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",H,[Object(c["createElementVNode"])("div",K,[Object(c["createElementVNode"])("button",{class:Object(c["normalizeClass"])(["tab-button",{active:"categories"===t.value}]),onClick:a[0]||(a[0]=e=>t.value="categories")}," Category Management ",2),Object(c["createElementVNode"])("button",{class:Object(c["normalizeClass"])(["tab-button",{active:"products"===t.value}]),onClick:a[1]||(a[1]=e=>t.value="products")}," Product Management ",2),Object(c["createElementVNode"])("button",{class:Object(c["normalizeClass"])(["tab-button",{active:"orders"===t.value}]),onClick:a[2]||(a[2]=e=>t.value="orders")}," Order Management ",2)]),Object(c["createElementVNode"])("div",X,["categories"===t.value?(Object(c["openBlock"])(),Object(c["createBlock"])(v,{key:0})):Object(c["createCommentVNode"])("",!0),"products"===t.value?(Object(c["openBlock"])(),Object(c["createBlock"])(T,{key:1})):Object(c["createCommentVNode"])("",!0),"orders"===t.value?(Object(c["openBlock"])(),Object(c["createBlock"])(G,{key:2})):Object(c["createCommentVNode"])("",!0)])]))}};a("1d19");const Z=j()(Y,[["__scopeId","data-v-a87f10cc"]]);t["default"]=Z},7049:function(e,t,a){"use strict";a("2a84")},7894:function(e,t,a){},9479:function(e,t,a){},"96b6":function(e,t,a){}}]);
//# sourceMappingURL=chunk-75821479.b2e90860.js.map